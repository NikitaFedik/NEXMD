      integer natom,npot,ihop,nquantumstep,nstep,nquantumreal
      integer nstepcross
      integer icontw,nstepw,icontini
      integer istepheat,iconttemperature,icontpdb,icont,nstepcoord
      integer txtinicoord,txtendcoord, nmax, nmaxpot,nmaxmo
      integer nbasis,nmaxbasis,nao 
! modified by Seba
!      integer iordenhop,ihopprev
      integer ihopprev
! end modified by Seba
      integer uumdqtflag
      integer iview,jend,decorhop
      integer iseedmdqt,conthop,conthop2
      double precision temp0,tempf,tempi,tao
! nmax is the maximum number of atoms allowed
! nmaxpot is the maximum number of electronic surfaces allowed
! nmaxbasis is the maximum of basis set allowed
      parameter(nmax=30) 
      parameter(nmaxpot=8) 
      parameter(nmaxbasis=nmax*nmax/2) 
      !parameter(nmaxbasis=qm2_struct%norbs) !JAKB added
! nmaxmo is the maximun number of molecular orbitals
!***************************************************
! ATENTION nmax should be greater or equal to Na_M defined in md.par
! ATENTION nmaxbasis should be greater or equal to M2_M defined in parH.par
! as M2M=2*M4_M being M4M=Np_M*Nh_M and Np_M=Nh_M=Nb_M/2
! ATENTION nmaxmo should be greater or equal to Nb_M defined in parH.par
!***************************************************
      parameter(nmaxmo=300)
      !parameter(nmaxmo=qm2_struct%norbs) !JAKB added
! added by Seba
      integer iordenhop(nmaxpot)
! end added by Seba
      integer iorden(260)
      integer,target :: atomtype(nmax)
! modified by Sebas#######################
!      integer lowvaluestep
!      double precision lowvalue 
      integer lowvaluestep(nmaxpot)
      double precision lowvalue(nmaxpot)
! end modified by Sebas#####################
      double precision tini0 
      double precision,target :: rx(nmax),ry(nmax),rz(nmax)
      double precision,target :: rxold(nmax),ryold(nmax),rzold(nmax)
      double precision,target :: deltaxxpold(nmax),deltayypold(nmax)
      double precision,target :: deltazzpold(nmax),deltaxxmold(nmax)
      double precision,target :: deltayymold(nmax),deltazzmold(nmax)
      double precision,target :: deltaxxpnew(nmax),deltayypnew(nmax)
      double precision,target :: deltazzpnew(nmax),deltaxxmnew(nmax)
      double precision,target :: deltayymnew(nmax),deltazzmnew(nmax)
      double precision,target :: vx(nmax),vy(nmax),vz(nmax)
      double precision,target :: vxold(nmax),vyold(nmax),vzold(nmax)
      double precision,target :: ax(nmax),ay(nmax),az(nmax)
      double precision,target :: axold(nmax),ayold(nmax),azold(nmax)
      double precision fxmdqt(nmax),fymdqt(nmax),fzmdqt(nmax)
      double precision,target ::massmdqt(nmax)
      double precision dtquantum,kin
      double precision,target ::dtnact, dtmdqt
      double precision vmdqt(nmaxpot)
      double precision bcoeffvmdqt(nmaxpot)
      double precision vmdqtnew(nmaxpot)
      double precision vmdqtmiddle(nmaxpot)
      double precision vmdqtmiddleold(nmaxpot)
      double precision vmdqtold(nmaxpot)
      double precision vnqcorrhoptot(nmaxpot,nmaxpot)
      double precision vnqcorrhop(nmaxpot,nmaxpot)
      double precision cadiab(nmaxpot,nmaxpot)
      double precision cadiab_analt(nmaxpot,nmaxpot)
      double precision cadiabnew(nmaxpot,nmaxpot)
      double precision cadiabold(nmaxpot,nmaxpot)
      double precision cadiabmiddle(nmaxpot,nmaxpot)
      double precision cadiabmiddleold(nmaxpot,nmaxpot)
      double precision bcoeffcadiab(nmaxpot,nmaxpot)
      double precision cmdqt(nmaxbasis,nmaxpot)
      double precision cmdqtold(nmaxbasis,nmaxpot)
      double precision cmdqtmiddleold(nmaxbasis,nmaxpot)
      double precision cmdqtmiddle(nmaxbasis,nmaxpot)
      double precision cmdqtnew(nmaxbasis,nmaxpot)
      double precision scpr(nmaxpot,nmaxpot)
      double precision cicoeffao2(nmaxbasis,nmaxpot)
      double precision uuold(nmaxmo,nmaxmo)
      double precision xcmini,ycmini,zcmini,masstot
      double precision tfemto 
      double precision tfemtoquantum 
      double precision nqold
      double precision kinini,vini,etotini 
      double precision vgs 
      double precision friction 
      double precision pfric(nmax),vfric(nmax),afric(nmax) 
      double precision prand(3,nmax),vrand(3,nmax) 
      double precision deltax 
      parameter(deltax=1.0d-4)
      character*2 atomtype2(nmax)
      character*4 state,prep
      character*6 ensemble 
      character*200 cardini
      character*4 ktbig(0:9999)
      character*200 txtinput(1000)
      double precision cadiabhop 
      double precision scprreal(nmaxpot,nmaxpot)

